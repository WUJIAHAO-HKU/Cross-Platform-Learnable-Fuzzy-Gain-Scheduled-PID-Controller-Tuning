================================================================================
加权元学习PID训练
================================================================================
📦 加载数据: 303个样本
   特征形状: (303, 4)
   标签形状: (303, 3)

📊 样本优化误差统计:
   平均: 58.98°
   中位: 25.19°
   最小: 0.00°
   最大: 176.88°
   <10°: 3 样本
   10-30°: 200 样本
   30-50°: 3 样本
   ≥50°: 97 样本

🔧 测试权重策略:

   inverse:
      权重范围: [0.169, 6.146]
      平均权重: 1.000
      权重标准差: 0.768
      低误差(<30°)平均权重: 1.376
      高误差(≥50°)平均权重: 0.223

   exponential:
      权重范围: [0.000, 5.036]
      平均权重: 1.000
      权重标准差: 0.899
      低误差(<30°)平均权重: 1.485
      高误差(≥50°)平均权重: 0.006

   threshold:
      权重范围: [0.100, 2.001]
      平均权重: 1.000
      权重标准差: 0.747
      低误差(<30°)平均权重: 1.439
      高误差(≥50°)平均权重: 0.100

✅ 选择权重策略: threshold
   策略说明:
      误差<20°: 权重1.0（优秀）
      误差20-35°: 权重0.5（良好）
      误差≥35°: 权重0.05（差，基本忽略）

📦 数据划分:
   训练样本: 242
   测试样本: 61
🖥️  使用设备: cuda

🚀 开始加权训练... (epochs=500)
   训练样本权重范围: [0.100, 2.001]
   训练样本平均权重: 0.985
Epoch 50/500 - Train Loss: 1.530928, Val Loss (weighted): 0.927785, Val Loss (raw): 0.652083
Epoch 100/500 - Train Loss: 1.318666, Val Loss (weighted): 0.718977, Val Loss (raw): 0.489069
Epoch 150/500 - Train Loss: 1.282605, Val Loss (weighted): 0.680688, Val Loss (raw): 0.466071
Epoch 200/500 - Train Loss: 1.272869, Val Loss (weighted): 0.678054, Val Loss (raw): 0.466166
⏹️  Early stopping at epoch 245
✅ 训练完成！最佳加权验证损失: 0.677940

📊 评估结果:

全体样本 (n=61):
   Kp 绝对误差: 11.2543
   Ki 绝对误差: 0.0000
   Kd 绝对误差: 3.3824
   总体平均: 4.8789

低优化误差样本 (优化误差<30°, n=43):
   Kp 绝对误差: 10.0090
   总体平均: 4.5676

高优化误差样本 (优化误差≥30°, n=18):
   Kp 绝对误差: 14.2292
   总体平均: 5.6225

💾 模型已保存: /home/wujiahao/基于强化学习的模型预测控制动力学模型误差在线补偿方法研究/rl_pid_linux/meta_learning/meta_pid_weighted.pth
📊 结果图已保存: /home/wujiahao/基于强化学习的模型预测控制动力学模型误差在线补偿方法研究/rl_pid_linux/meta_learning/weighted_training_results.png

================================================================================
✅ 加权训练完成！
================================================================================
