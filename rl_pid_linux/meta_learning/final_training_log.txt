================================================================================
加权元学习PID训练
================================================================================
📁 加载数据: augmented_pid_data_filtered.json
📦 加载数据: 203个样本
   特征形状: (203, 4)
   标签形状: (203, 3)

📊 样本优化误差统计:
   平均: 19.45°
   中位: 24.29°
   最小: 0.00°
   最大: 25.64°
   <10°: 3 样本
   10-30°: 200 样本
   30-50°: 0 样本
   ≥50°: 0 样本

🔧 测试权重策略:

   inverse:
      权重范围: [0.720, 4.412]
      平均权重: 1.000
      权重标准差: 0.481
      低误差(<30°)平均权重: 1.000

   exponential:
      权重范围: [0.603, 3.330]
      平均权重: 1.000
      权重标准差: 0.471
      低误差(<30°)平均权重: 1.000

   threshold:
      权重范围: [0.688, 1.376]
      平均权重: 1.000
      权重标准差: 0.343
      低误差(<30°)平均权重: 1.000

✅ 选择权重策略: strict
   策略说明:
      误差<25°: 权重1.0（保留）
      误差≥25°: 权重0.0（完全排除）
      目标：只用高质量样本，确保最高预测精度
   ⚠️  strict模式：排除89个样本（误差≥25.0°）

📦 数据划分:
   训练样本: 162
   测试样本: 41
🖥️  使用设备: cuda

🚀 开始加权训练... (epochs=500)
   训练样本权重范围: [0.000, 1.781]
   训练样本平均权重: 1.011
Epoch 50/500 - Train Loss: 1.329038, Val Loss (weighted): 0.886708, Val Loss (raw): 0.692528
Epoch 100/500 - Train Loss: 1.165619, Val Loss (weighted): 0.802283, Val Loss (raw): 0.830782
Epoch 150/500 - Train Loss: 1.151274, Val Loss (weighted): 0.821068, Val Loss (raw): 0.894001
⏹️  Early stopping at epoch 151
✅ 训练完成！最佳加权验证损失: 0.801943

📊 评估结果:

全体样本 (n=41):
   Kp 绝对误差: 12.2549
   Ki 绝对误差: 0.0000
   Kd 绝对误差: 4.0372
   总体平均: 5.4307

低优化误差样本 (优化误差<30°, n=41):
   Kp 绝对误差: 12.2549
   总体平均: 5.4307

💾 模型已保存: /home/wujiahao/基于强化学习的模型预测控制动力学模型误差在线补偿方法研究/rl_pid_linux/meta_learning/meta_pid_weighted.pth
📊 结果图已保存: /home/wujiahao/基于强化学习的模型预测控制动力学模型误差在线补偿方法研究/rl_pid_linux/meta_learning/weighted_training_results.png

================================================================================
✅ 加权训练完成！
================================================================================
