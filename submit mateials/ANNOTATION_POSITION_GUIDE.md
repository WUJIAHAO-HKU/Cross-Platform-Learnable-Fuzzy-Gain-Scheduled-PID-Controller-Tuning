# 📍 成本对比图标注框位置调整指南

## 当前标注框位置说明

图表中有 **4个主要标注框**，每个标注框由两个关键参数控制位置：

### 位置参数说明
- `xy=(x, y)` - 箭头指向的数据点位置（通常不需要改）
- `xytext=(x, y)` - 文本框的位置（**这是您需要调整的**）

---

## 标注框1: Break-even Point（左上角橙色框）
```python
ax.annotate('Break-even at\n2-3 robots vs.\nmanual tuning', 
            xy=(2.5, cost_manual_low[1]),  # 箭头指向：机器人数量=2.5的位置
            xytext=(6, 150),               # 文本框位置：x=6, y=150
            ...
```

**调整建议：**
- **向右移动**：增大 `xytext` 第一个数字，如 `(8, 150)` 或 `(10, 150)`
- **向上移动**：增大第二个数字，如 `(6, 200)` 或 `(6, 250)`
- **向左移动**：减小第一个数字，如 `(4, 150)`
- **向下移动**：减小第二个数字，如 `(6, 100)`

---

## 标注框2: Our Method @ 100 robots（中部绿色框）
```python
ax.annotate(f'Our method @ 100 robots:\n${cost_ours[6]:.1f}K\n(99.5% savings)', 
            xy=(100, cost_ours[6]),        # 箭头指向：x=100的位置
            xytext=(250, 8),               # 文本框位置：x=250, y=8
            ...
```

**调整建议：**
- **向右移动**：增大 x 值，如 `(300, 8)` 或 `(350, 8)`
- **向上移动**：增大 y 值，如 `(250, 15)` 或 `(250, 20)`
- **向左移动**：减小 x 值，如 `(200, 8)` 或 `(180, 8)`
- **向下移动**：减小 y 值，如 `(250, 5)` 或 `(250, 3)`

---

## 标注框3: Manual Tuning @ 100（中上部红色框）
```python
ax.annotate(f'Manual tuning @ 100:\n${cost_manual_low[6]:.0f}K - ${cost_manual_high[6]:.0f}K', 
            xy=(100, cost_manual_low[6]),  # 箭头指向：x=100的位置
            xytext=(180, 3500),            # 文本框位置：x=180, y=3500
            ...
```

**调整建议：**
- **向右移动**：增大 x 值，如 `(220, 3500)` 或 `(250, 3500)`
- **向上移动**：增大 y 值，如 `(180, 4000)` 或 `(180, 5000)`
- **向左移动**：减小 x 值，如 `(150, 3500)` 或 `(120, 3500)`
- **向下移动**：减小 y 值，如 `(180, 3000)` 或 `(180, 2500)`

---

## 标注框4: Meta-learning Competitive（右上角紫色框）
```python
ax.annotate('Meta-learning competitive\nonly at 200+ robots\n(0.3% of manufacturers)', 
            xy=(200, cost_meta_low[7]),    # 箭头指向：x=200的位置
            xytext=(320, 15000),           # 文本框位置：x=320, y=15000
            ...
```

**调整建议：**
- **向右移动**：增大 x 值，如 `(350, 15000)` 或 `(400, 15000)`
- **向上移动**：增大 y 值，如 `(320, 18000)` 或 `(320, 20000)`
- **向左移动**：减小 x 值，如 `(280, 15000)` 或 `(250, 15000)`
- **向下移动**：减小 y 值，如 `(320, 12000)` 或 `(320, 10000)`

---

## 快速调整步骤

### 方法1：直接修改 generate_cost_figure.py

找到对应的 `ax.annotate()` 代码行，修改 `xytext=(x, y)` 参数：

```python
# 例如：将绿色标注框向右移动50单位
# 原来：xytext=(250, 8)
# 修改为：xytext=(300, 8)

ax.annotate(f'Our method @ 100 robots:\n${cost_ours[6]:.1f}K\n(99.5% savings)', 
            xy=(100, cost_ours[6]), 
            xytext=(300, 8),  # ← 这里修改
            ...
```

### 方法2：批量调整（推荐）

如果您告诉我具体哪个标注框需要往哪个方向移动多少，我可以帮您直接修改代码。

例如：
- "把绿色框向右移50，向上移5"
- "把红色框向左移30"
- "把紫色框向下移2000"

---

## 常见调整场景

### 场景1：标注框重叠
**问题**: 绿色框和红色框离得太近
**解决**: 
- 将绿色框向右移：`xytext=(300, 8)` → `(350, 8)`
- 或将红色框向左移：`xytext=(180, 3500)` → `(150, 3500)`

### 场景2：标注框超出图表范围
**问题**: 文字被裁剪
**解决**: 
- 减小 x 或 y 值，使标注框向图表中心移动
- 或在保存图片前添加：`plt.tight_layout()`（已有）

### 场景3：箭头太长或太短
**问题**: 箭头指向不清晰
**解决**: 调整 `xytext` 使其更接近（或远离）`xy` 点

---

## 坐标系统参考

### X轴（机器人数量）
- 左边界：~1
- SME区域：10-100（绿色阴影区）
- 右边界：~500

### Y轴（成本，对数刻度）
- 底部（我们的方法）：~0.025 ($25)
- 中部：~100-1000
- 顶部：~10,000-20,000

**重要**: Y轴是对数刻度，所以：
- 10 → 100 的距离 ≈ 100 → 1000 的距离
- 调整Y坐标时，数量级很重要（如1000 vs 10000是明显变化）

---

## 其他可调整的样式参数

如果您想调整标注框的外观而不是位置：

### 文字大小
```python
fontsize=11  # 改为 9, 10, 12, 13 等
```

### 框的颜色和透明度
```python
bbox=dict(
    boxstyle='round,pad=0.5',
    facecolor='lightgreen',  # 背景色
    alpha=0.9                # 透明度 0-1
)
```

### 箭头样式
```python
arrowprops=dict(
    arrowstyle='->',           # 箭头类型：'->', '-|>', 'fancy', 'simple'
    color='darkgreen',         # 箭头颜色
    lw=2.5,                    # 箭头线宽
    connectionstyle='arc3,rad=-0.2'  # 箭头弯曲：rad正值向上弯，负值向下弯
)
```

---

## 快速测试

修改完成后，重新运行脚本即可看到效果：

```bash
cd "/home/wujiahao/基于强化学习的模型预测控制动力学模型误差在线补偿方法研究/submit mateials"
python3 generate_cost_figure.py
```

图片会自动覆盖旧的 `cost_scaling_comparison.png` 文件。

---

## 需要帮助？

请告诉我：
1. **哪个标注框**需要调整（颜色或内容描述）
2. **往哪个方向**移动（上/下/左/右）
3. **移动多少**（大致距离，如"一点点"/"很多"）

我会直接帮您修改代码并重新生成图表！
